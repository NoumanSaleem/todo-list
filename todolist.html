<html>
    <head>
        <style>
        .block {
            display: inline-block;
            width: 250px;
        }
        </style>
        <title>
            To-Do List
        </title>
    </head>
    <body>
        <h1>To-Do List</h1>
        <form id="form" action="">
            <input class="block" style="padding: 10px" id="input" placeholder="Add New To-Do Item"><br>
            <input class="block" style="text-align: center" type="time" id="time" value="12:00" required ><br>
            <input class="block" style="text-align: center" type="date" id="date" required ><br>
            <button class="block" id="addBtn">Add to List</button></form>
            <button class="block" id="clrBtn">Clear List</button>
        <ul id="list"></ul>
                            
    <script>
        var data = [];
        const addBtn = document.querySelector("#addBtn");
        const input = document.querySelector("#input");
        const form = document.querySelector("#form");
        var list = document.querySelector("#list");
        var date = document.querySelector("#date");
        var time = document.querySelector("#time");
        const clrBtn = document.querySelector("#clrBtn");
        document.querySelector("#date").valueAsDate = new Date();
        storage = window.localStorage;
        var key = data.length;
        /*const addClick = (e) => {
            e.preventDefault();
            const newToDo = document.createElement("div");
            newToDo.innerHTML = "<code>(" + (listArray.length + 1) + ")</code> " + input.value + "<br><code>by " + time.value + " on " + date.value + "</code>";
            newToDo.className = "newToDo";
            list.insertBefore(newToDo, list.lastChild);
            listArray.push(input.value);
            console.log(listArray);
        }*/
        form.addEventListener("submit", function(e){
            e.preventDefault();
            //list.innerHTML += "<li>" + input.value + "<code> by " + time.value + " on " + date.value + "</code></li>";
            data.push({"key": key, "text": input.value, "done": false});
            var newlist = document.createElement("li");
            newlist.textContent = input.value + " ";
            newlist.appendChild(dltBtn());
            list.insertBefore(newlist, list.childNodes[0]);
            save();
            key++;
            input.value = "";
        }, false);

        const clrClick = (e) => {
            e.preventDefault();
            list.innerHTML = "";
            storage.clear();            
            key = 0;
        }

        function deletePost(e) {
            e.preventDefault();
            e.target.parentNode.remove();
            key--;
        }

        function dltBtn(){
            var dltBtn = document.createElement("button");
            dltBtn.textContent = "Delete";
            dltBtn.addEventListener("click", deletePost);
            return dltBtn;
        }

        function save() {
            storage.setItem("data", JSON.stringify(data));
        }

        function getSaved() {
            saved = JSON.parse(storage.getItem("data"));
            if (!saved) {
                list.innerHTML = "";
            }
            else {
                for (var i=0; i<saved.length; i++){
                    list.innerHTML = saved[i];
                }
            }
        }
        getSaved();
        //addBtn.addEventListener("click", addClick, false);
        clrBtn.addEventListener("click", clrClick, false);
    </script>
    </body>
</html>